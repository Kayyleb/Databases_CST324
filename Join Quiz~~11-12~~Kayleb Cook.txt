#1
SELECT title , author , original_url
FROM bigquery-public-data.open_images.images AS t1
JOIN bigquery-public-data.open_images.annotations_bbox AS t2
ON t1.image_id = t2.image_id
WHERE t2.is_occluded IS TRUE;

#2
SELECT original_url
FROM bigquery-public-data.open_images.images AS t1
JOIN bigquery-public-data.open_images.labels AS t2
ON t1.image_id = t2.image_id
WHERE t2.confidence = 1;

#3
SELECT title , author , t1.image_id ,
CASE WHEN COUNTIF(t2.source = 'human') > 0 THEN 'human' END AS source,
COUNTIF(t2.source = 'human') AS human_label_count
FROM bigquery-public-data.open_images.images AS t1
JOIN bigquery-public-data.open_images.labels AS t2
ON t2.image_id = t1.image_id
GROUP BY t1.image_id, t1.title, t1.author
ORDER BY t1.image_id;
